download src code and reset to nerdctl 1.5.0
--------------------------------------------


docker buildkit
---------------
try build up base image with nerdctl dir mounted inside with --mount option, error occurs:
```text
$ make
docker build -t nerdctl:test --build-arg HTTP_PROXY=http://10.144.1.10:8080 --build-arg HTTPS_PROXY=http://10.144.1.10:8080 .
Sending build context to Docker daemon  218.7MB
Step 1/7 : FROM alpine:3.18
 ---> 8ca4688f4f35
Step 2/7 : ENV http_proxy='http://10.144.1.10:8080'
 ---> Using cache
 ---> 60ccf9e0e19f
Step 3/7 : ENV https_proxy='http://10.144.1.10:8080'
 ---> Using cache
 ---> ee030d83b288
Step 4/7 : RUN apk update &&     apk add --no-cache vim &&     apk add --no-cache make &&     apk add --no-cache go &&     apk add --no-cache git &&     apk add --no-cache containerd &&     apk add --no-cache openrc &&     rm -rf /var/cache/apk/*
 ---> Using cache
 ---> 8b217c5d6bff
Step 5/7 : RUN --mount=type=bind,source=/repo1/metung/txt/nerdctl/nerdctl,target=/nerdctl     --mount=type=bind,source=/repo1/metung/txt/nerdctl/containerd,target=/containerd
the --mount option requires BuildKit. Refer to https://docs.docker.com/go/buildkit/ to learn how to build images with BuildKit enabled
```
solution ref: https://docs.docker.com/go/buildkit/


error when try make nerdctl and containerd
------------------------------------------
```text
$ cd /nerdctl
$ make all
...
error obtaining VCS status: exit status 128
        Use -buildvcs=false to disable VCS stamping.
make: *** [Makefile:57: nerdctl] Error 1
```

see following diff patch to make it work:
```text
diff --git a/Makefile b/Makefile
index 844ae72..eae05e2 100644
--- a/Makefile
+++ b/Makefile
@@ -37,7 +37,7 @@ VERSION_TRIMMED := $(VERSION:v%=%)
 REVISION ?= $(shell git rev-parse HEAD)$(shell if ! git diff --no-ext-diff --quiet --exit-code; then echo .m; fi)

 GO_BUILD_LDFLAGS ?= -s -w
-GO_BUILD_FLAGS ?=
+GO_BUILD_FLAGS ?= -buildvcs=false
 export GO_BUILD=GO111MODULE=on CGO_ENABLED=0 GOOS=$(GOOS) $(GO) build -ldflags "$(GO_BUILD_LDFLAGS) -X $(PACKAGE)/pkg/version.Version=$(VERSION) -X $(PACKAGE)/pkg/version.Revision=$(REVISION)"

 ifdef VERBOSE
/repo1/metung/txt/nerdctl
```

install containerd on alpine
----------------------------
install containerd apk and openrc for startup it as a service:
```text
$ apk add containerd containerd-openrc

$ rc-service --help
sh: rc-service: not found

$ apk add openrc --no-cache   # containerd-openrc seems not work
```

startup containerd using openrc on alpine:
ref: https://gist.github.com/runlevel5/5064c1121e5b41d9a246b587f602bd91

```text
$ rc-update add containerd default
* service containerd added to runlevel default

$ rc-service containerd start
* WARNING: containerd is already starting
```

check if service started?
```text
$ rc-service -s containerd
$ echo $?
0

$ rc-service -s top
* rc-service: service `top' does not exist
$ echo $?
1
```

